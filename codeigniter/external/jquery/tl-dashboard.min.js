function $jqCache(e){return this.cache=this.cache||{},this.cache[e]||(this.cache[e]=$(e)),this.cache[e]}function log(e){console.log(e)}$jqCache(document).ready(function(){NAVBAR.$navBurgerMenu.click(SIDEBAR.toggleSidebar),NAVBAR.$subTopicHeading.click(PAGE_CONTENT.openPreviousGridSection),TOOLBAR.$toolbarSearch.click(SIDEBAR.launchSidebarSearch),TOOLBAR.$toolDropdownToggle.click(TOOLBAR.toggleToolDropDown),$jqCache(document).on("click",".a-sidebar-navbar-tab:not(.disabled)",SIDEBAR.switchActiveSidebarNavSection),$jqCache(document).on("click",".li-grid-tracker-item",PAGE_CONTENT.gridboxFocus),$jqCache(document).on("dblclick",".li-grid-tracker-item",PAGE_CONTENT.toggleGridboxSelect),$jqCache(document).on("mouseleave",".li-grid-tracker-item",PAGE_CONTENT.gridboxUnfocus),SIDEBAR.$addResourceLi.click(POPUP.popupAddResource),SIDEBAR.$collapsibleSidebarMenuLi.click(SIDEBAR.toggleSidebarSubmenu),SIDEBAR.initGridTracker(),SIDEBAR.$nonCollapsibleSidebarMenuLi.click(SIDEBAR.switchActiveSidebarMenu),SIDEBAR.$searchCategory.click(SIDEBAR.selectSearchCategory),SIDEBAR.$searchCross.click(SIDEBAR.selectClearSearchBar),SIDEBAR.$searchNavButton.click(SIDEBAR.selectClearSearchBar),$jqCache(document).on("click","body",PAGE_CONTENT.clearGridboxSelections),$jqCache(document).on("click",".div-gridbox",PAGE_CONTENT.openGridbox),$jqCache(document).on("click",".div-selection-checkbox",PAGE_CONTENT.toggleGridboxSelect),$jqCache(document).on("mouseenter",".div-gridbox",HELPER.displayIcons),$jqCache(document).on("mouseleave",".div-gridbox:not(.selected)",HELPER.hideIcons),PAGE_CONTENT.initPageContentGrid(),PAGE_CONTENT.refreshPageGrid("bank"),$jqCache(document).on("click",".a-question-popup-tab:not(.w--current)",POPUP.switchActiveQuestionPopupTab),$jqCache(document).on("click",".div-answer-wrapper *:not(.div-qna-header)",HELPER.stopEventPropagation),$jqCache(document).on("click",".div-answer-wrapper:not(.expanded)",HELPER.displayIcons),$jqCache(document).on("click",".div-answer-wrapper.expanded",HELPER.hideIcons),$jqCache(document).on("click",".div-answer-wrapper",POPUP.toggleQuestionAnswerForm),$jqCache(document).on("mouseenter",".div-answer-wrapper.expanded",HELPER.displayIcons),$jqCache(document).on("mouseenter",".div-question-comment-wrapper",HELPER.displayIcons),$jqCache(document).on("mouseenter",".div-question-wrapper",HELPER.displayIcons),$jqCache(document).on("mouseleave",".div-answer-wrapper.expanded",HELPER.hideIcons),$jqCache(document).on("mouseleave",".div-question-comment-wrapper",HELPER.hideIcons),$jqCache(document).on("mouseleave",".div-question-wrapper",HELPER.hideIcons),POPUP.$popupBackground.click(POPUP.removePopup)});var HELPER={array2D:function(e){for(var a=[],r=0;r<e;r++)a[r]=[];return a},callController:function(e){return siteUrl+"/"+e},displayIcons:function(){$(this).find(".icon-wrapper").fadeTo(200,1)},hideIcons:function(){$(this).find(".icon-wrapper").fadeTo(200,0)},loadAsset:function(e){return baseUrl+e},stopEventPropagation:function(e){e.stopPropagation()}},NAVBAR={$navBurgerMenu:$(".btn-navbar-menu"),$subTopicHeading:$(".h-sub-topic-heading"),updateMainTopicHeading:function(e){$jqCache(".h-main-topic-heading").html(e)},updateSubTopicHeading:function(e){$jqCache(".h-sub-topic-heading").html(e)}},TOOLBAR={defaultGridStatusText:"",selectedGridboxCount:0,$toolbarSearch:$("#toolbar-search"),$toolDropdownToggle:$(".div-tool-dropdown-toggle"),toggleToolDropDown:function(){"1"===$(this).attr("data-tool-toggle")&&$(this).toggleClass("pressed")}},SIDEBAR={$addResourceLi:$(".a-sidebar-submenu"),$activeSidebarMenuLi:$(".a-sidebar-menu-li").eq(0),$collapsibleSidebarMenuLi:$(".a-sidebar-menu-li.collapsible"),$gridTracker:$(".ul-sidebar-questions-list"),$nonCollapsibleSidebarMenuLi:$(".a-sidebar-menu-li:not(.collapsible)"),$searchCategory:$(".a-sidebar-search-category"),$searchCross:$(".img-clear-tt-sidebar-search"),$searchNavButton:$("#btn-sidebar-search"),searchValue:"",buildGridTracker:function(){if(0===PAGE_CONTENT.pageGridItemsCount)return"<li>No grid items</li>";for(var e="",a=1;a<=PAGE_CONTENT.pageGridItemsCount;a++)e+='<li class="li-grid-tracker-item" data-grid-tracker-item-id="'+a+'">'+a+"</li>";SIDEBAR.$gridTracker.html(e)},closeGridTracker:function(){$jqCache("#img-grid-tracker-chapter-gold").removeClass("img-appear"),$jqCache("#img-grid-tracker-chapter-grey").addClass("img-appear"),$jqCache("#a-sidebar-grid-tracker-tab").addClass("disabled"),SIDEBAR.$gridTracker.sortable("disable"),$jqCache("#a-sidebar-grid-tracker-tab").hasClass("active")&&($jqCache("#a-sidebar-grid-tracker-tab").removeClass("active"),$jqCache("#a-sidebar-menu-tab").addClass("active"),$jqCache("#div-sidebar-grid-tracker").removeClass("appear"),$jqCache(".div-sidebar-menu").addClass("appear"))},deactivateSidebarMenuLi:function(){null!=SIDEBAR.$activeSidebarMenuLi&&(SIDEBAR.$activeSidebarMenuLi.removeClass("active"),SIDEBAR.$activeSidebarMenuLi=null)},getThisSidebarSubmenu:function(e){return e.next()},initGridTracker:function(){SIDEBAR.$gridTracker.sortable({disabled:!0,scroll:!1,update:function(e,a){for(var r,t,i=$jqCache(".ul-sidebar-questions-list").sortable("toArray",{attribute:"data-grid-tracker-item-id"}),s=a.item,o=parseInt(s.html()),d=toIndex=o-1;o<i[toIndex];)r=$jqCache(".ul-sidebar-questions-list").children(".li-grid-tracker-item").eq(toIndex),t=parseInt(r.html())-1,r.html(t),r.attr("data-grid-tracker-item-id",t),toIndex++;for(;o>i[toIndex];)r=$jqCache(".ul-sidebar-questions-list").children(".li-grid-tracker-item").eq(toIndex),t=parseInt(r.html())+1,r.html(t),r.attr("data-grid-tracker-item-id",t),toIndex--;s.html(toIndex+1),s.attr("data-grid-tracker-item-id",toIndex+1),PAGE_CONTENT.$pageGrid.move(d,toIndex),s.trigger("click")}})},launchGridTracker:function(){SIDEBAR.buildGridTracker(),$jqCache("#img-grid-tracker-chapter-grey").removeClass("img-appear"),$jqCache("#img-grid-tracker-chapter-gold").addClass("img-appear"),$jqCache("#a-sidebar-grid-tracker-tab").removeClass("disabled"),SIDEBAR.$gridTracker.sortable("enable"),$jqCache(".div-sidebar-scroll").hasClass("sidebar-close")&&SIDEBAR.toggleSidebar(),$jqCache(".a-sidebar-navbar-tab").removeClass("active"),$jqCache("#a-sidebar-grid-tracker-tab").addClass("active"),$jqCache(".div-sidebar-navbar-tab-pane").removeClass("appear"),$jqCache("#div-sidebar-grid-tracker").addClass("appear")},launchSidebarSearch:function(){$jqCache(".div-sidebar-scroll").hasClass("sidebar-close")&&SIDEBAR.toggleSidebar(),$jqCache(".div-sidebar-navbar-tab-pane").removeClass("appear"),$jqCache(".a-sidebar-navbar-tab").removeClass("active"),$jqCache("#a-sidebar-search-tab").addClass("active"),$jqCache("#div-sidebar-search").addClass("appear"),$jqCache(".a-sidebar-search-category").removeClass("checked"),$jqCache(".div-tt-search-category-checkbox").removeClass("checked"),$jqCache("#current-section-search-category").addClass("checked"),$jqCache("#current-section-search-category").children(".div-tt-search-category-checkbox").addClass("checked"),$jqCache(".text-field-tt-search").select(),SIDEBAR.updateSearchBarPlaceholder("Current Section")},selectClearSearchBar:function(){$jqCache(".text-field-tt-search").val(""),$jqCache(".text-field-tt-search").select()},selectSearchCategory:function(){$jqCache(".a-sidebar-search-category").removeClass("checked"),$jqCache(".div-tt-search-category-checkbox").removeClass("checked"),$(this).addClass("checked"),$(this).children(".div-tt-search-category-checkbox").addClass("checked");var e=$(this).children(".text-tt-search-category").html();SIDEBAR.selectClearSearchBar(),SIDEBAR.updateSearchBarPlaceholder(e)},switchActiveSidebarMenu:function(){$jqCache(".a-sidebar-menu-li").removeClass("active"),$(this).addClass("active");var e=$(this).attr("data-action"),a=$(this).is(SIDEBAR.$activeSidebarMenuLi);if("refresh-grid"===e&&!a){var r=$(this).attr("data-title");PAGE_CONTENT.refreshPageGrid(r),NAVBAR.updateMainTopicHeading(r+"s"),NAVBAR.updateSubTopicHeading(""),SIDEBAR.$activeSidebarMenuLi=$(this)}},switchActiveSidebarNavSection:function(){switch($(".a-sidebar-navbar-tab").removeClass("active"),$(this).addClass("active"),$jqCache(".div-sidebar-navbar-tab-pane").removeClass("appear"),$(this).attr("id")){case"a-sidebar-menu-tab":$jqCache("#div-sidebar-menu").addClass("appear");break;case"a-sidebar-inbox-tab":$jqCache("#div-sidebar-messages").addClass("appear");break;case"a-sidebar-search-tab":$jqCache("#div-sidebar-search").addClass("appear");break;case"a-sidebar-grid-tracker-tab":$jqCache("#div-sidebar-grid-tracker").addClass("appear")}},toggleSidebar:function(){$jqCache(".div-sidebar-scroll").toggleClass("sidebar-close"),$jqCache(".div-page-content-wrapper").toggleClass("stretch")},toggleSidebarSubmenu:function(){SIDEBAR.getThisSidebarSubmenu($(this)).toggleClass("appear"),$(this).children(".img-sidebar-li-expand").toggleClass("appear"),$(this).children(".img-sidebar-li-collapse").toggleClass("appear")},updateSearchBarPlaceholder:function(e){$jqCache(".text-field-tt-search").attr("placeholder",e)}},PAGE_CONTENT={currentGridParentFullID:"",$focusedGridbox:null,$pageGrid:null,pageGridItemsCount:0,previousGridSectionData:[],gridboxesAreSelected:!1,clearGridboxSelections:function(){PAGE_CONTENT.gridboxesAreSelected&&($jqCache(".text-grid-status").html(TOOLBAR.defaultGridStatusText),$jqCache(".text-grid-status").removeClass("selected"),$jqCache(".div-selection-checkbox").removeClass("selected"),$jqCache(".div-gridbox").removeClass("selected"),$jqCache(".div-gridbox-footer").removeClass("selected"),TOOLBAR.selectedGridboxCount=0)},filter:function(){grid.filter(function(e){var a=e.getElement(),r=!SIDEBAR.searchValue||-1<(a.getAttribute("data-title")||"").toLowerCase().indexOf(searchFieldValue),t=!filterFieldValue||(a.getAttribute("data-color")||"")===filterFieldValue;return r&&t})},getGridboxTitle:function(e){return e.children(".div-gridbox-header").children(".h-gridbox-title").html()},getGridboxNumberElement:function(e){return $(e.getElement()).find(".text-gridbox-numbering")},getGridItems:function(e){var a=[];return e.forEach(function(e){element=document.createElement("div"),element.innerHTML=e,a.push(element.firstChild)}),a},gridboxFocus:function(e){e.stopPropagation();var a=$(this).html()-1;PAGE_CONTENT.$focusedGridbox=$(".div-gridbox").eq(a),PAGE_CONTENT.$focusedGridbox.addClass("outline-div-gridbox");var r=PAGE_CONTENT.$focusedGridbox.offset().top-350;$jqCache("html, body").animate({scrollTop:r},500)},gridboxUnfocus:function(){null!=PAGE_CONTENT.$focusedGridbox&&(PAGE_CONTENT.$focusedGridbox.removeClass("outline-div-gridbox"),PAGE_CONTENT.$focusedGridbox=null)},initPageContentGrid:function(){PAGE_CONTENT.$pageGrid=new Muuri(".div-page-content-grid",{dragEnabled:!1,items:".div-gridbox-wrapper",sortData:{gridboxNumber:function(e,a){var r=PAGE_CONTENT.getGridboxNumberElement(e).html();return parseInt(r)}},layout:function(e,a,r){if(!e.length)return c;var t,i,s,o,d,c={slots:{},height:0,setHeight:!0},n=a/e[0]._width,l=1+parseInt(e.length/n),u=HELPER.array2D(l);return e.forEach(function(e,a){t={left:0,top:0,height:e._height,width:e._width},d=a%n,o=parseInt(a/n),PAGE_CONTENT.topRowExists(o)&&(i=u[o-1][d],t.top=i.top+i.height),PAGE_CONTENT.leftColExists(d)&&(s=u[o][d-1],t.left=s.left+s.width),u[o][d]=t,c.slots[e._id]=t,c.height=Math.max(c.height,t.top+t.height)}),c}}).on("move",function(e){for(var a,r=e.fromIndex,t=e.toIndex,i=PAGE_CONTENT.$pageGrid.getItems();r<t;)a=PAGE_CONTENT.getGridboxNumberElement(i[r]),r++,a.html(r);for(;t<r;)(a=PAGE_CONTENT.getGridboxNumberElement(i[r])).html(r+1),r--;PAGE_CONTENT.getGridboxNumberElement(e.item).html(t+1),PAGE_CONTENT.$pageGrid.refreshSortData(),PAGE_CONTENT.$pageGrid.synchronize()})},leftColExists:function(e){return e-1!=-1},openGridbox:function(){SIDEBAR.deactivateSidebarMenuLi();var e=$(this).data("full-json-id"),a=$(this).data("grid-section"),r=$(this).data("grid-child-section");if("question"===a)POPUP.popupQuestionTabs(e);else{PAGE_CONTENT.refreshPageGrid(r,e);var t=PAGE_CONTENT.getGridboxTitle($(this));NAVBAR.updateMainTopicHeading(r+"s"),NAVBAR.updateSubTopicHeading(t),PAGE_CONTENT.savePreviousGridSectionData(a)}},openPreviousGridSection:function(){PAGE_CONTENT.previousGridSectionData.pop()},savePreviousGridSectionData:function(e){var a={section:e,gridParentFullId:PAGE_CONTENT.currentGridParentFullId};PAGE_CONTENT.previousGridSectionData.push(a)},refreshPageGrid:function(r,e){var t=PAGE_CONTENT.$pageGrid.getItems();PAGE_CONTENT.$pageGrid.remove(t,{removeElements:!0,layout:!1});var a="dashboard/ajax_get_grid_views/"+r;$.post(HELPER.callController(a),{grid_box_full_json_id:JSON.stringify(e)}).done(function(e){var a=JSON.parse(e);PAGE_CONTENT.pageGridItemsCount=a.length,"chapter"===r||"question"===r?(SIDEBAR.launchGridTracker(),PAGE_CONTENT.$pageGrid._settings.dragEnabled=!0):(SIDEBAR.closeGridTracker(),PAGE_CONTENT.$pageGrid._settings.dragEnabled=!1),t=PAGE_CONTENT.getGridItems(a),PAGE_CONTENT.$pageGrid.add(t)})},toggleGridboxSelect:function(e){var a;e.stopPropagation(),$(e.target).is($(".li-grid-tracker-item"))?(a=PAGE_CONTENT.$focusedGridbox.find(".div-selection-checkbox"),PAGE_CONTENT.gridboxUnfocus()):a=$(this),a.hasClass("selected")?(TOOLBAR.selectedGridboxCount--,0===TOOLBAR.selectedGridboxCount?($jqCache(".text-grid-status").html(TOOLBAR.defaultGridStatusText),$jqCache(".text-grid-status").removeClass("selected"),PAGE_CONTENT.gridboxesAreSelected=!1):$jqCache(".text-grid-status").html("Clear "+TOOLBAR.selectedGridboxCount+" Selection(s)")):(TOOLBAR.selectedGridboxCount++,1===TOOLBAR.selectedGridboxCount&&(TOOLBAR.defaultGridStatusText=$jqCache(".text-grid-status").html(),PAGE_CONTENT.gridboxesAreSelected=!0),$jqCache(".text-grid-status").html("Clear "+TOOLBAR.selectedGridboxCount+" Selection(s)"),$jqCache(".text-grid-status").addClass("selected")),a.toggleClass("selected"),a.parents(".div-gridbox").toggleClass("selected"),a.siblings(".div-gridbox-footer").toggleClass("selected")},topRowExists:function(e){return e-1!=-1}},POPUP={$popupBackground:$(".popup-background"),$popupWrapper:$(".div-generic-popup-wrapper"),popupElementsToDisplay:[],answerFormIsExpanded:!1,popupAddResource:function(){switch(POPUP.popupElementsToDisplay.push(POPUP.$popupBackground),POPUP.popupElementsToDisplay.push(POPUP.$popupWrapper),POPUP.popupElementsToDisplay.push($jqCache(".div-add-resource")),POPUP.displayPopup(),$(this).attr("id")){case"sidebar-submenu-add-question":$jqCache(".h-resource-main").html("Add Question");break;case"sidebar-submenu-add-chapter":$jqCache(".h-resource-main").html("Add Chapter");break;case"sidebar-submenu-add-bank":$jqCache(".h-resource-main").html("Add Bank");break;case"sidebar-submenu-add-course":$jqCache(".h-resource-main").html("Add Course");break;case"sidebar-submenu-add-school":$jqCache(".h-resource-main").html("Add School")}},popupQuestionTabs:function(e){$.post(HELPER.callController("dashboard/ajax_get_question_tab_popup_view/"),{grid_box_full_json_id:JSON.stringify(e)}).done(function(e){var a=JSON.parse(e);$(".tabs-question").replaceWith(a),POPUP.popupElementsToDisplay.push(POPUP.$popupBackground),POPUP.popupElementsToDisplay.push(POPUP.$popupWrapper),POPUP.popupElementsToDisplay.push($(".tabs-question")),POPUP.displayPopup()})},removePopup:function(e){POPUP.popupElementsToDisplay.forEach(function(e){e.removeClass("appear")}),POPUP.popupElementsToDisplay=[],POPUP.answerFormIsExpanded=!1},displayPopup:function(){POPUP.popupElementsToDisplay.forEach(function(e){e.addClass("appear")})},switchActiveQuestionPopupTab:function(){var e=$(".a-question-popup-tab:not(.w--current)");$(".a-question-popup-tab").removeClass("w--current"),e.addClass("w--current");var a=$(".tab-pane-question-popup:not(.w--tab-active)");$(".tab-pane-question-popup").removeClass("w--tab-active"),a.addClass("w--tab-active")},toggleQuestionAnswerForm:function(e){POPUP.answerFormIsExpanded?($(this).children(".form-block-answer").removeClass("appear"),$(this).removeClass("expanded"),POPUP.answerFormIsExpanded=!1):($(this).children(".form-block-answer").addClass("appear"),$(this).addClass("expanded"),POPUP.answerFormIsExpanded=!0)}};